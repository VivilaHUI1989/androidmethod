<html>
<head>
<title>图形按钮等控件的功能改变的时候替代文本也应随功能改变</title>
<link href="style.css" type="text/css" rel="Stylesheet"/>
<style type="text/css">
</style>
</head>
<body>
<img src="yanjiuhuilogo.png" class="logo"/><br/>
<a href="index.html">首页</a><a href="index.html"><p>返回</p></a>
<h3>图形按钮等控件的功能改变的时候替代文本也应随功能改变</h3>
<hr/>
<ol>
<li><h4>【问题描述】</h4>
<hr/>
<p>图形按钮等控件的功能改变但是替代文本没有改变屏幕阅读器用户无法清楚的知道此控件的功能已经改变，给用户使用产品带来很大的困扰。</p>
</li>
<li><h4>【问题代码】</h4>
<hr/>
<p>下面是MainActivity.java代码，此代码中按钮的功能改变但是替代文本没有改变</p>
<textarea rows="32" cols="120">
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageButton;

public class MainActivity extends Activity {  
	private boolean bookState;
	private ImageButton book;
    	@Override  
   	protected void onCreate(Bundle savedInstanceState) {  
        	super.onCreate(savedInstanceState);  
       		setContentView(R.layout.activity_main); 
		book = (ImageButton) findViewById(R.id.book);
		bookState = false;
		state();
		book.setOnClickListener(new View.OnClickListener() {
			@Override
			public void onClick(View v) {
			bookState = !bookState;
			state();
			}
		});
	}
	private void state() {
		if (bookState) {
			book.setImageResource(R.drawable.book_open);
		}
		else {
			book.setImageResource(R.drawable.book_closed);
		}
	}
}
</textarea>
<p>下面是MainActivity.xml中的代码:</p>
<textarea rows="14" cols="120">
<LinearLayout
	xmlns:android="http://schemas.android.com/apk/res/android"
	android:layout_width="match_parent"
	android:layout_height="match_parent"
	android:orientation="vertical">

	<ImageButton
		android:id="@+id/book"
		android:layout_width="50dp"
		android:layout_height="50dp"
		android:src="@drawable/book_closed"
		android:contentDescription="书籍"/>
</LinearLayout>
</textarea>
</li>
<li><h4>【问题解决方案描述】</h4>
<hr/>
<p>图形按钮等控件的功能改变的时候应该随功能的改变改变替代文本，让用户能清除的知道现在此控件的功能。在代码中可以用setContentDescription()方法改变android:contentDescription属性。</p>
</li>
<li><h4>【解决方案】</h4>
<hr/>
<p>下面是MainActivity.java代码，此代码中按钮的功能改变但是替代文本没有改变</p>
<textarea rows="36" cols="120">
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageButton;

public class MainActivity extends Activity {  
	private boolean bookState;
	private ImageButton book;
    	@Override  
    	protected void onCreate(Bundle savedInstanceState) {  
        	super.onCreate(savedInstanceState);  
        	setContentView(R.layout.activity_main);  
		book = (ImageButton) findViewById(R.id.book);
		bookState = false;
		state();
		book.setOnClickListener(new View.OnClickListener() {
			@Override
			public void onClick(View v) {
				bookState = !bookState;
				state();
			}
		});
	}
	private void state() {
		if (bookState) {
			book.setImageResource(R.drawable.book_open);
			//动态改变替代文本
			Book.setContentDescription(“打开书籍”);
		}
		else {
			book.setImageResource(R.drawable.book_closed);
			//动态改变替代文本
			Book.setContentDescription(“关闭书籍”);
		}
	}
}
</textarea>
<p>下面是MainActiv
ity.xml中的代码:</p>
<textarea rows="15" cols="120">
<LinearLayout
	xmlns:android="http://schemas.android.com/apk/res/android"
	android:layout_width="match_parent"
	android:layout_height="match_parent"
	android:orientation="vertical">

	<ImageButton
		android:id="@+id/book"
		android:layout_width="50dp"
		android:layout_height="50dp"
		android:src="@drawable/book_closed"
		android:contentDescription="书籍"
		<!—下面的代码使得contentDescription改变之后马上播报给用户，让用户及时知道按钮的功能改变—>
		android:accessibilityLiveRegion=”polite”/>
</LinearLayout>
</textarea>
</li>
<li><h4>【前后效果图对比】</h4>
<hr/>
<table>
<tr>
<td><img src="17-1.png" class="litu" alt="优化前，未点击和点击后分别朗读“书籍按钮”“书籍按钮”"/></td><td><img src="17-2.png" class="litu" alt="优化后，未点击和点击后分别朗读“关闭书籍按钮”“打开书籍按钮”"/></td>
</tr>
<tr>
<td>优化前，未点击和点击后分别朗读“书籍按钮”“书籍按钮”</td><td>优化后，未点击和点击后分别朗读“关闭书籍按钮”“打开书籍按钮”</td></tr>
</table>
</li>
<li><h4>【扩展】</h4>
<hr/>
<p></p>
</li>
<li><h4>【更多】</h4>
<hr/>

</li>
</ol>
</body>
</html>